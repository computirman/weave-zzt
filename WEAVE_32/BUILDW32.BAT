@echo off

if not exist BIN mkdir BIN
del BIN\*.*

if not exist DIST mkdir DIST
del DIST\*.*
cd DIST
if not exist WEAVEDMO mkdir WEAVEDMO
del WEAVEDMO\*.*
if not exist IMAGES mkdir IMAGES
del IMAGES\*.*
if not exist UTILS mkdir UTILS
del UTILS\*.*
cd..

echo.
echo [ Building ZZT.EXE ]
echo.
TPC /B /EBIN /GD /ISRC_W32 /USRC_W32 SRC_W32\ZZT.PAS
if errorlevel 1 goto error
echo.
echo [ Compressing ZZT.EXE ]
echo.
cd BIN
..\TOOLS\UPX.EXE --8086 ZZT.EXE
cd ..

echo.
echo [ Creating DIST/ ]
echo.

copy BIN\ZZT.EXE DIST\ZZT.EXE
copy BIN\ZZT.DAT DIST\ZZT.DAT
copy LICENSE.TXT DIST\LICENSE.TXT
copy OOP-QR.TXT DIST\OOP-QR.TXT
copy README.TXT DIST\README.TXT
copy SRC_W32\TEMPLATE.CFG DIST\TEMPLATE.CFG
copy SRC_W32\TEMPLATE.INI DIST\TEMPLATE.INI
copy SRC_W32\EXTENDED.CFG DIST\EXTENDED.CFG
copy SRC_W32\WEAVEZZT.CFG DIST\WEAVEZZT.CFG
copy SRC_W32\WEAVEDMO.INI DIST\WEAVEDMO\WEAVEDMO.INI
copy SRC_W32\WEAVEDMO.CFG DIST\WEAVEDMO\WEAVEDMO.CFG
copy SRC_W32\EXAMPLE.OBJ DIST\WEAVEDMO\EXAMPLE.OBJ
copy SRC_W32\WONKY.OBJ DIST\WEAVEDMO\WONKY.OBJ
copy SRC_W32\ANGRY.OBJ DIST\WEAVEDMO\ANGRY.OBJ
copy SRC_W32\GREET.OBJ DIST\WEAVEDMO\GREET.OBJ
copy SRC_W32\THING.OBJ DIST\WEAVEDMO\THING.OBJ
copy SRC_W32\THAT.OBJ DIST\WEAVEDMO\THAT.OBJ
copy SRC_W32\BEARBUL.OBJ DIST\WEAVEDMO\BEARBUL.OBJ
copy SRC_W32\LICENSE.TXT DIST\WEAVEDMO\LICENSE.TXT
copy SRC_W32\USING_~1.HTM DIST\!HOW_TO.HTM
copy SRC_W32\HOWTO1.png DIST\IMAGES\HOWTO1.png
copy SRC_W32\HOWTO2.png DIST\IMAGES\HOWTO2.png
copy SRC_W32\HOWTO3.png DIST\IMAGES\HOWTO3.png
copy WEAVEDMO.ZZT DIST\WEAVEDMO\WEAVEDMO.ZZT
copy COMPAT.ZZT DIST\WEAVEDMO\COMPAT.ZZT
copy TOOLS\LOOMZZT.ZIP DIST\UTILS\LOOMZZT.ZIP
copy TOOLS\WEBZZT32.ZIP DIST\UTILS\WEBZZT32.ZIP
copy TOOLS\WEBWEAVE.ZIP DIST\UTILS\WEBWEAVE.ZIP
copy TOOLS\ZLOOM2.ZIP DIST\UTILS\ZLOOM2.ZIP
goto done
:error
echo.
echo [ Error detected! Stopping. ]
:done
copy DIST\ZZT.EXE DIST\WEAVE3.EXE

